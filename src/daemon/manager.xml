<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
"http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">

<node name="/com/ubuntu/OnlineAccounts/Manager">
  <interface name="com.ubuntu.OnlineAccounts.Manager">

    <!--
        GetAccounts: returns a list containing account information for
        accounts that provide one of a list of service IDs.
    -->
    <method name="GetAccounts">
      <arg name="service_ids" type="as" direction="in" />
      <arg name="accounts" type="a(ua{sv})" direction="out" />
      <annotation name="org.qtproject.QtDBus.QtTypeName.Out0"
                  value="QList&lt;AccountInfo&gt;"/>
    </method>

    <!--
        GetAccountInfo: return information about a given account ID
    -->
    <method name="GetAccountInfo">
      <arg name="service_id" type="s" direction="in" />
      <arg name="account_id" type="u" direction="in" />
      <arg name="details" type="(ua{sv})" direction="out" />
      <annotation name="org.qtproject.QtDBus.QtTypeName.Out0" value="AccountInfo"/>
    </method>

    <!--
        Authenticate: request authentication credentials for the given
        account ID in the context of a particualr service.

        If "interactive" is false, an error will be returned if
        user interaction would be required to retrieve the
        credentials.

        If "invalidate" is true, any stored credentials will be
        ignored and new credentials will be requested from the account
        provider.
    -->
    <method name="Authenticate">
      <arg name="service_id" type="s" direction="in" />
      <arg name="account_id" type="u" direction="in" />
      <arg name="interactive" type="b" direction="in" />
      <arg name="invalidate" type="b" direction="in" />
      <!-- <arg name="reply_socket" type="h" direction="in" /> -->
      <arg name="credentials" type="a{sv}" direction="out" />
      <annotation name="org.qtproject.QtDBus.QtTypeName.Out0" value="QVariantMap"/>
    </method>

    <!--
        Register: register a new account for use with the given
        service.
    -->
    <method name="Register">
      <arg name="service_id" type="s" direction="in" />
      <!-- <arg name="reply_socket" type="h" direction="in" /> -->
      <arg name="account" type="(ua{sv})" direction="out" />
      <annotation name="org.qtproject.QtDBus.QtTypeName.Out0" value="AccountInfo"/>
      <arg name="credentials" type="a{sv}" direction="out" />
      <annotation name="org.qtproject.QtDBus.QtTypeName.Out1" value="QVariantMap"/>
    </method>

    <!--
        AccountChanged: emitted when account details are changed.

        This signal will be emitted when new accounts are enabled, and
        when existing accounts are disabled.  Clients can detect these
        cases by checking the "enabled" flag and comparing the account
        ID with the list of accounts they currently know about.

        The actual changed account details can be retrieved with
        GetAccountInfo().
    -->
    <signal name="AccountChanged">
      <arg name="service_id" type="s" />
      <arg name="account_id" type="u" />
      <arg name="enabled" type="b" />
    </signal>

    <!--
        CredentialsChanged: emitted when the credentials for the given
        service ID on the given account change.

        The new credentials can be retrieved with Authenticate().
    -->
    <signal name="CredentialsChanged">
      <arg name="service_id" type="s" />
      <arg name="account_id" type="u" />
    </signal>

  </interface>
</node>
